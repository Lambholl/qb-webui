<!DOCTYPE html>
<html lang="${LANG}">

<head>
    <meta charset="UTF-8" />
    <title>qBittorrent QBT_TR(Web UI)QBT_TR[CONTEXT=OptionsDialog]</title>
    <link rel="icon" type="image/png" href="images/skin/qbittorrent32.png" />
    <link rel="stylesheet" type="text/css" href="css/login.css" />
    <script src="scripts/lib/mootools-1.2-core-yc.js"></script>
    <noscript>
        <link rel="stylesheet" type="text/css" href="css/noscript.css?v=${VERSION}" />
    </noscript>
    <script>
        window.onload = function() {
            $('username').focus();
            $('username').select();
        };

        window.addEvent('domready', function() {
            $('loginform').addEvent('submit', function(e) {
                new Event(e).stop();
                submitLoginForm();
            });
        });

        function submitLoginForm() {
            new Request({
                url: 'api/v2/auth/login',
                method: 'post',
                data: $('loginform').toQueryString(),
                onComplete: function() {
                    $('password').set('value', '');
                },
                onFailure: function(xhr) {
                    if (xhr.responseText !== "") {
                        $('error_msg').set('html', xhr.responseText);
                    }
                    else {
                        $('error_msg').set('html', 'QBT_TR(Unable to log in, qBittorrent is probably unreachable.)QBT_TR[CONTEXT=HttpServer]');
                    }
                },
                onSuccess: function(text) {
                    if (text == "Ok.") {
                        // Session started. Simply reload page.
                        window.location.reload();
                    }
                    else {
                        $('error_msg').set('html', 'QBT_TR(Invalid Username or Password.)QBT_TR[CONTEXT=HttpServer]');
                    }
                }
            }).send();
        }
        
        var icons = [
            'images/login/qb01.jpg',
            'images/login/qb02.jpg',
            'images/login/qb03.gif',
            'images/login/sayaka03.png'
        ];
        
        function setRandomIcon() {
            var icon_url = icons[Math.floor(Math.random()*4)];
            document.getElementById('logoimg').src = icon_url;
        }
    </script>
</head>

<body onload='setRandomIcon();'>
    <noscript id="noscript">
        <h1>QBT_TR(JavaScript Required! You must enable JavaScript for the Web UI to work properly)QBT_TR[CONTEXT=HttpServer]</h1>
    </noscript>
    <div id="main">
        <h1>qBittorrent QBT_TR(Web UI)QBT_TR[CONTEXT=OptionsDialog]</h1>
        <div id="logo" class="col">
            <img id='logoimg' alt="qBittorrent logo" />
        </div>
        <div id="formplace" class="col">
            <form id="loginform" method="post">
                <div class="row">
                    <label for="username">QBT_TR(Username)QBT_TR[CONTEXT=HttpServer]</label><br />
                    <input type="text" id="username" name="username" /></div>
                <div class="row">
                    <label for="password">QBT_TR(Password)QBT_TR[CONTEXT=HttpServer]</label><br />
                    <input type="password" id="password" name="password" /></div>
                <div class="row">
                    <input type="submit" id="login" value="QBT_TR(Login)QBT_TR[CONTEXT=HttpServer]" />
                </div>
            </form>
        </div>
        <div id="error_msg"></div>
    </div>
</body>

</html>
